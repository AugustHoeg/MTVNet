
{
  "task": "superresolution",
  "model": "plain",
  "model_architecture": "SuperFormer",

  // WandB parameters
  "wandb_entity": "aulho",
  "wandb_project": "Xtreme-CT",
  "experiment_id": "ps32_4x_debug_ID000034",
  "run_name": "SuperFormer_test_",
  "note": "Enter note about experiment here",

  "is_train": true,

  "gpu_ids": [0],
  "dist": false,
  "up_factor": 4,  // upscaling factor

  "path": {
    "root": "superresolution",
    "pretrained_netG": null,
    "pretrained_netE": null,
    "pretrained_optimizerG": null
  },

  "datasets": {
      "name": "HCP_1200",  // "TEST_DATASET" "2022_QIM_52_Bone" "IXI" "HCP_1200" "KIRBY21" "BRATS2023" "2022_QIM_52_Bone_Block",
      "dataset_type": "MonaiSmartCacheDataset",   // "MonaiDataset" "MonaiSmartCacheDataset" "MonaiIterableDataset" "MonaiCacheDataset"

      "n_channels": 1,  // number of input channels of data samples
      "patch_size": 32,  // Low-resolution patch size. High-resolution has size LR*UP_FACTOR
      "downsampling_method": "linear",  // used when degradation type is "resize"
      "degradation_type": "resize",  // "resize" "kspace_trunc"
      "factor_truncate": 4.0,  // Used wen degradation type is "kspace_trunc"
      "kspace_trunc_keep_shape": false,

    "train": {
      "dataset_params": {  // Used for MonaiSmartCacheDataset
        "patches_per_batch": 2,  // number of patches to sample for each batch
        "replace_rate": 0.10,
        "cache_num": 78,
        "init_workers": 5,
        "replace_workers": 5
      },

      "dataloader_params": {  // Used for MonaiDataset
        "dataloader_shuffle": false,
        "dataloader_batch_size": 1,
        "num_load_workers": 0,
        "persist_workers": false,
        "pin_memory": false
      },

      "split": "train"
    },

    "test": {
      "dataset_params": {  // Used for MonaiSmartCacheDataset
        "patches_per_batch": 2,  // number of patches to sample for each batch
        "replace_rate": 0.10,
        "cache_num": 111,
        "init_workers": 5,
        "replace_workers": 5
      },

      "dataloader_params": {  // Used for MonaiDataset
        "dataloader_shuffle": true,
        "dataloader_batch_size": 1,
        "num_load_workers": 0,
        "persist_workers": false,
        "pin_memory": false
      },

      "split": "test"
    }
  },
  "netG": {
    "net_type": "SuperFormer",
    "description": "3D Transformer-based SR model from SuperFormer paper",
    "window_size": 8,
    "img_range": 1.0,
    "depths": [6, 6, 6],      // Default is [6, 6, 6]
    "embed_dim": 192,         // Default is 252, tested 126 working, 192 working, 128 not working
    "num_heads": [6, 6, 6],   // Default is [6, 6, 6]
    "mlp_ratio": 2,
    "upsampler": null,  // null "pixelshuffle" "pixelshuffledirect" "nearest+conv"

    "resi_connection": "1conv",
    "ape": false,
    "rpb": true,
    "output_type": "direct",
    "num_feat": 126,           // Default is 126
    "patch_size": 2,  // 2

    "use_checkpoint": false,    // Testing pre-implemented gradient checkpointing of SuperFormer, August

    "init_type": "default",
    "init_bn_type": null,      // "uniform" | "constant"
    "init_gain": 0.0
  },

  "train": {

    "epochs": 50,  // Maximum number of epochs
    "mixed_precision": "FP16",

    "G_loss_weights": {
      "MSE": 0,
      "L1": 1.0,
      "BCE_Logistic": 0,
      "BCE": 0,
      "VGG": 0,
      "VGG3D": 0.006,  // 0.006
      "GRAD": 0,
      "LAPLACE": 0,
      "TV3D": 0,  // 0.1
      "TEXTURE3D": 0,  // 0.5
      "ADV": 0,  // 10**-3,  // is 0.1 in mDCSRN-GAN paper, but uses WGAN-GP instead of vanilla GAN
      "STRUCTURE_TENSOR": 0  // 10**-7
    },

    "E_decay": 0,

    "G_optimizer_type": "adam",
    "G_optimizer_lr": 2e-4, // 2e-4,
    "G_optimizer_wd": 0,

    "G_optimizer_clipgrad": 10,
    "G_optimizer_reuse": true,
    "G_scheduler_type": "MultiStepLR",
    "G_scheduler_milestones": [
      250000,
      400000,
      450000,
      475000,
      500000
    ],

    "G_scheduler_gamma": 0.5,
    "G_regularizer_orthstep": null,
    "G_regularizer_clipstep": null,

    "G_param_strict": true,
    "E_param_strict": true,

    "manual_seed": 8351,
    "checkpoint_test": 100,
    "checkpoint_save": 1000000,
    "checkpoint_print": 100,
    "checkpoint_save_visuals": 100
  },
  "test": {
    "performance_metrics": ["psnr", "ssim", "nrmse"],
    "upscaling_methods": ["tio_nearest", "tio_linear"]
  }
}
